<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Static App Lab: LocalDB Studio</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="pwa/manifest.json" />
</head>
<body>
  <header class="app-header">
    <div>
      <h1>Static App Lab: LocalDB Studio</h1>
      <p class="subtitle">Offline-first personal database â€” no backend, no dependencies.</p>
    </div>
    <div id="sw-update" class="banner hidden">
      <span>New version available.</span>
      <button id="sw-reload" class="btn">Reload</button>
    </div>
  </header>

  <nav class="tabs" role="tablist">
    <button class="tab active" data-tab="list" role="tab">List</button>
    <button class="tab" data-tab="editor" role="tab">Editor</button>
    <button class="tab" data-tab="import-export" role="tab">Import-Export</button>
    <button class="tab" data-tab="dashboard" role="tab">Dashboard</button>
    <button class="tab" data-tab="settings" role="tab">Settings</button>
  </nav>

  <main>
    <section id="tab-list" class="tab-panel active" role="tabpanel">
      <div class="panel grid">
        <div class="controls">
          <label>
            Search
            <input id="search-input" type="search" placeholder="Search title or body" />
          </label>
          <label>
            Status
            <select id="status-filter">
              <option value="all">All</option>
              <option value="active">Active</option>
              <option value="archived">Archived</option>
            </select>
          </label>
          <label>
            Tag
            <select id="tag-filter">
              <option value="">All tags</option>
            </select>
          </label>
          <label>
            Min rating
            <select id="rating-filter">
              <option value="0">0+</option>
              <option value="1">1+</option>
              <option value="2">2+</option>
              <option value="3">3+</option>
              <option value="4">4+</option>
              <option value="5">5</option>
            </select>
          </label>
          <label>
            Sort
            <select id="sort-filter">
              <option value="updated-desc">Updated (newest)</option>
              <option value="updated-asc">Updated (oldest)</option>
              <option value="created-desc">Created (newest)</option>
              <option value="created-asc">Created (oldest)</option>
              <option value="title-asc">Title A-Z</option>
              <option value="title-desc">Title Z-A</option>
            </select>
          </label>
        </div>

        <div class="list-area">
          <div class="list-header">
            <div>
              <strong id="list-count">0</strong> records
              <span id="list-indicator" class="indicator hidden">Virtualized list active for 10,000+ records</span>
            </div>
            <button id="new-record" class="btn primary">New Record</button>
          </div>
          <div id="list-virtual-scroll" class="virtual-scroll">
            <div class="virtual-spacer"></div>
            <ul id="record-list" class="record-list"></ul>
          </div>
        </div>

        <div class="detail-panel" id="detail-panel">
          <div class="detail-empty">Select a record to see details.</div>
          <div class="detail-content hidden">
            <h3 id="detail-title"></h3>
            <p id="detail-body"></p>
            <div class="chips" id="detail-tags"></div>
            <div class="detail-meta">
              <span id="detail-status"></span>
              <span id="detail-rating"></span>
            </div>
            <div class="detail-meta">
              <span id="detail-created"></span>
              <span id="detail-updated"></span>
            </div>
            <div class="detail-actions">
              <button id="detail-edit" class="btn">Edit</button>
              <button id="detail-duplicate" class="btn">Duplicate</button>
              <button id="detail-archive" class="btn">Archive</button>
              <button id="detail-delete" class="btn danger">Delete</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="tab-editor" class="tab-panel" role="tabpanel">
      <div class="panel">
        <div class="editor-header">
          <div>
            <h2 id="editor-title">Create Record</h2>
            <p class="muted">Manage record fields and save to IndexedDB.</p>
          </div>
          <label class="switch">
            <input id="autosave-toggle" type="checkbox" />
            <span>Autosave</span>
          </label>
        </div>
        <form id="editor-form" class="form">
          <input type="hidden" id="record-id" />
          <label>
            Title <span class="required">*</span>
            <input id="record-title" type="text" required />
          </label>
          <label>
            Body
            <textarea id="record-body" rows="6" placeholder="Notes, ideas, or content"></textarea>
          </label>
          <label>
            Tags (comma-separated)
            <input id="record-tags" type="text" placeholder="work, personal, research" />
          </label>
          <div class="form-grid">
            <label>
              Status
              <select id="record-status">
                <option value="active">Active</option>
                <option value="archived">Archived</option>
              </select>
            </label>
            <label>
              Rating
              <input id="record-rating" type="range" min="0" max="5" value="3" />
              <span id="rating-value" class="muted"></span>
            </label>
          </div>
          <div class="form-actions">
            <button id="save-record" class="btn primary" type="submit">Save</button>
            <span id="save-status" class="muted"></span>
          </div>
        </form>
      </div>
    </section>

    <section id="tab-import-export" class="tab-panel" role="tabpanel">
      <div class="panel import-grid">
        <div>
          <h2>Export</h2>
          <p class="muted">Backup your data as JSON or CSV.</p>
          <button id="export-json" class="btn">Export JSON</button>
          <button id="export-csv" class="btn">Export CSV</button>
        </div>
        <div>
          <h2>Import</h2>
          <p class="muted">Merge or replace records from a JSON or CSV file.</p>
          <div class="import-controls">
            <input id="import-file" type="file" accept=".json,.csv" />
            <label>
              Mode
              <select id="import-mode">
                <option value="merge">Merge by ID</option>
                <option value="replace">Replace all</option>
              </select>
            </label>
            <button id="preview-import" class="btn">Preview</button>
            <button id="commit-import" class="btn primary" disabled>Import</button>
          </div>
          <p id="import-preview" class="muted"></p>
          <p class="notice">
            Reminder: Browser storage can be cleared by the user or system. Regular exports are your backup.
          </p>
        </div>
      </div>
    </section>

    <section id="tab-dashboard" class="tab-panel" role="tabpanel">
      <div class="panel">
        <h2>Dashboard</h2>
        <div class="dashboard-grid">
          <div class="card">
            <h3>Totals</h3>
            <p id="dash-total"></p>
            <p id="dash-active"></p>
            <p id="dash-archived"></p>
          </div>
          <div class="card">
            <h3>Top Tags</h3>
            <ul id="dash-tags" class="stack"></ul>
          </div>
          <div class="card">
            <h3>Rating Distribution</h3>
            <ul id="dash-ratings" class="stack"></ul>
          </div>
          <div class="card">
            <h3>Recently Updated</h3>
            <ul id="dash-recent" class="stack"></ul>
          </div>
        </div>
      </div>
    </section>

    <section id="tab-settings" class="tab-panel" role="tabpanel">
      <div class="panel settings-grid">
        <div>
          <h2>Sample Data</h2>
          <p class="muted">Generate realistic sample records without freezing the UI.</p>
          <div class="button-row">
            <button id="generate-100" class="btn">Generate 100</button>
            <button id="generate-10000" class="btn">Generate 10,000</button>
          </div>
        </div>
        <div>
          <h2>Maintenance</h2>
          <button id="reset-demo" class="btn">Reset demo</button>
          <button id="clear-data" class="btn danger">Clear all data</button>
          <div class="storage-info">
            <p id="storage-count"></p>
            <p id="storage-size"></p>
          </div>
        </div>
        <div>
          <h2>PWA Status</h2>
          <p id="pwa-status" class="muted"></p>
          <p id="display-mode" class="muted"></p>
        </div>
      </div>
    </section>
  </main>

  <div id="toast" class="toast hidden"></div>

  <script type="module" src="app.js"></script>
</body>
</html>
